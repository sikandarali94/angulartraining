<div class="container">
  <div class="row">
    <div class="col-xs-12 col-sm-10 col-md-8 col-sm-offset-1 col-md-offset-2">
      <!--
      We are recreating this form using the reactive approach.
      -->
      <!--
      We want to synchronize our HTML inputs with our form in our Typescript code. Angular is auto-detecting that
      the form tags below is a form and it creates a form for us. We don't want it to do that. To override this
      behaviour we use formGroup with property binding. This tells Angular to take our form group from the Typescript
      code instead of inferring one or creating a form for us.
      -->
      <!--
      The difference from template driven approach is that we don't need to get a local reference of the form.
      -->
      <form [formGroup]="signupForm" (ngSubmit)="onSubmit()">
        <!--
        formControlName is used to tell Angular which property in our TypeScript object representing the form relates
        to which input. formGroupName is used to tell Angular which container element holds the form controls for
        the form group. We provide formGroupName the name we gave to the form group in our model.
        -->
        <div formGroupName="userData">
          <div class="form-group">
            <label for="username">Username</label>
            <!--
            [formGroup] synchronises our HTML form with our Typescript code, however, we need to tell Angular which
            inputs relate to which form controls we defined in our Typescript code. We don't need to use property
            binding because username is a string (we could write [formControlName]="'username'" but this is needlessly
            complicated).
            -->
            <input
              type="text"
              id="username"
              formControlName="username"
              class="form-control">
            <!--
            In the .get method we could either pass a control name or a path to the control (which we will explore later).
            Here we provided the path to the username form control that is within the userData form group. We provide
            paths that are linked with '.', as shown below.
            -->
            <span
              *ngIf="!signupForm.get('userData.username').valid && signupForm.get('userData.username').touched"
              class="help-block">
              <!--
              We can use the errors property to create more specific error messages, as shown below.
              -->
              <span *ngIf="signupForm.get('userData.username').errors['nameIsForbidden']">
                This name is invalid!
              </span>
              <!--
              required:true key-value pair is stored in the errors property of the form control that has the required
              validator if the form control value is left empty.
              -->
              <span *ngIf="signupForm.get('userData.username').errors['required']">
                This field is required!
              </span>
            </span>
          </div>
          <div class="form-group">
            <label for="email">email</label>
            <input
              type="text"
              id="email"
              formControlName="email"
              class="form-control">
            <span
              *ngIf="!signupForm.get('userData.email').valid && signupForm.get('userData.email').touched"
              class="help-block">Please enter a valid email!</span>
          </div>
        </div>
        <div class="radio" *ngFor="let gender of genders">
          <label>
            <input
              type="radio"
              formControlName="gender"
              [value]="gender">{{ gender }}
          </label>
        </div>
        <!--
        We are using formArrayName directive to synchronise this HTML form with the form array we created in our model.
        -->
        <div formArrayName="hobbies">
          <h4>Your Hobbies</h4>
          <!--
          When a user clicks this button we want to dynamically add a form control here.
          -->
          <button class="btn btn-default" type="button" (click)="onAddHobby()">Add Hobby</button>
          <!--
          We can loop through all the form controls in our form array and display them as form elements on our HTML
          page. We are also getting the index of each form control element in the array because Angular assigns the
          name of each form control in form array to the index value. In the JS representation of the form a hobbies
          property is created in the value property and it holds the values of the form controls of the hobbies
          form array.
          -->
          <div
            class="form-group"
            *ngFor="let hobbyControl of signupForm.get('hobbies').controls; let i = index">
            <!--
            We are using property binding on formControlName because we are not passing a string but a local variable
            that holds the index of the form control element in the form array.
            -->
            <input type="text" class="form-control" [formControlName]="i">
          </div>
        </div>
        <!--
        For a general form validation message, we don't need the .get() method.
        -->
        <span
          *ngIf="!signupForm.valid && signupForm.touched"
          class="help-block">Please enter valid data!</span>
        <button class="btn btn-primary" type="submit">Submit</button>
      </form>
    </div>
  </div>
</div>
